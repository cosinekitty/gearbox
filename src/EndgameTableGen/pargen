#!/bin/bash
if [[ -z "$1" ]]; then
    SWEEPER=forward
else
    SWEEPER=$1
fi
CONFIG=Release
NTHREADS=4
rm -rf ../../tables/*.endgame ../../tables/work_*
dotnet build --configuration ${CONFIG} || exit $?
bin/${CONFIG}/net5.0/EndgameTableGen pgen 2 ${NTHREADS} ${SWEEPER} || exit $?
if [[ -f ../../tables/reference/endgame.sha256 ]]; then
    cd ../../tables/
    sha256sum -c reference/endgame.sha256 || exit $?
fi
exit 0
